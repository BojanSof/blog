---
title: My Homelab
date: 2025-06-20
categories: [Networking, Homelab]
tags: [networking, homelab, vm, containers, docker, proxmox]
math: false
image:
  path: /assets/img/homelab/homelab.webp
---

Homelab is personal IT environment used for learning, experimenting and self-hosting services.
Personally, it allowed me to learn a lot of new things regarding networking, security, self-hosting applications and managing the whole environment.
In this blog post, I am going to describe my homelab, the process of creating it and some of the challenges I found during the development.

## Brief history of my homelab

Earlier this year, I moved to new appartment.
While I was packing the boxes with stuff from the old appartment, I found old [FritzBox](https://fritz.com/en) all-in-one router and DSL modem in one of the storage shelves.
The specific model was [FritzBox 7360SL](https://boxmatrix.info/wiki/FRITZ!Box_Fon_WLAN_7360_SL).
To me such boxes like this are very fascinating because they are basically embedded Linux machines, which have potential to do a lot of other stuff beside their main purpose.
How cool it is to have VPN server to your home network running on the router itself!
Or blocking ads for the whole network!

I had experience with modding other FritzBox device - around 1 and a half year ago, I was trying to mod another FritzBox device to run [Freetz](https://freetz.github.io/)(the maintained fork of the project is [Freetz-NG](https://freetz-ng.github.io/freetz-ng/)) - firmware modifications for FritzBox which allows to run custom packages on the FritzBox, like VPN servers, HTTP servers, custom DNS, etc.
Also I'll use this opportunity to mention that there is a whole wiki page for FritzBox devices, [BoxMatrix](https://boxmatrix.info/wiki/BoxMatrix).
It contains a lot of technical details for many different FritzBox devices.
I had the fortune to colaborate with the maintainer of BoxMatrix, hippie2000, to get Freetz running on my FritzBox, from whom I learnt a lot of stuff regarding what it takes to mod and adapt linux configurations and modules.
Kudos to him!
I used this FritzBox device to run OpenVPN server to access the home network, and I was running [dnsmasq](https://en.wikipedia.org/wiki/Dnsmasq) with [Addhole](https://freetz-ng.github.io/freetz-ng/make/addhole/?h=addhole) extension, to block list of hostnames that contain ads, malwares, trackers and other unwanted things.
It also helped me learn about terms like [Dynamic DNS](https://en.wikipedia.org/wiki/Dynamic_DNS) and [DMZ](https://en.wikipedia.org/wiki/DMZ_(computing)), and see how to practically use them.
But it wasn't the smoothest experience, as the hardware was a bit outdated and didn't have a lot of power.

Now going back to packing the FritzBox 7360SL, I made a quick google search on it, and I've noticed that [OpenWRT](https://openwrt.org/) supports this device.
I always wanted to try OpenWRT, Linux targetting embedded devices, mainly handling networking tasks.
It is a great way to keep old equipment, unsupported by the manufacturer anymore, running with the latest Linux kernel version, security patches and bug fixes.
OpenWRT also has very big comprehensive package list.

After moving to the new appartment, I had some time and started playing with the FritzBox 7360SL.
I installed OpenWRT on it following [OpenWRT guide](https://openwrt.org/toh/avm/fritz.box.wlan.7360), I was amazed how many confiugrations and customizations were available in the Web UI, making the hardware feel so powerful.
Creating network interfaces, creating VLANs, managing firewall zones, looking at the enormous OpenWRT package list were things that opened the doors to many new learning opportunities.

Quickly after that, I got introduced to [Proxmox](https://pve.proxmox.com/wiki/Main_Page) - server virtualization management solution based on QEMU/KVM and LXC (Linux Containers).
I bought myself cheap refurbished HP260 G2 mini PC, with i3-6100U 2-core/4-thread CPU, 8 GB RAM and 256 GB SSD.
It has a very small form-factor, making it easy to put it under table or in a corner.
I've installed Proxmox on it and started spinning out VMs and LXCs - Adguard Home for DNS, InfluxDB and Grafana for monitoring the PC, Nginx Reverse Proxy, host my WebRTC chat application, self-host Music library, and many more.

My latest update to the homelab equipment was [GL.iNet Flint 2](https://www.gl-inet.com/products/gl-mt6000/), a high-performance router, which I got as gift for my birthday.
The Flint 2 is considered one of the best OpenWRT routers from many users - it has very power CPU (MediaTek Filogic 830, MT7986AV), 1 GB RAM and 8 GB eMMC, two 2.5 Gbit ports and four 1 Gbit ports, and USB 3.1 port.
It upgraded the FritzBox 7360SL device, which was behaving weirdly sometimes - WiFi was disconnecting and it was becoming unresponsive.
Now, the whole networks feels much smoother.

## Diagram

![Homelab diagram](/assets/img/homelab/homelab.svg){: .light}
![Homelab diagram](/assets/img/homelab/homelab-dark.svg){: .dark}
_Diagram of my current homelab_

The homelab is pretty simple.
The Flint 2 is connected to the ISP gateway.
The ISP gateway is NOT configured in bridge mode, as I need to contact the ISP to configure the gateway in bridge mode.
The HP 260 G2 is the server running proxmox and all containers and VMs.
Before I had the Flint 2, the FritzBox 7360SL was doing its job.

> One thing that I found useful with the FritzBox 7360SL, which has small amount of internal Flash memory, is to use small external USB drive to extend the root file system, to have storage for installing packages. OpenWRT wiki has [tutorial](https://openwrt.org/docs/guide-user/additional-software/extroot_configuration) how to achieve this.
{: .prompt-info }

### Router config

The Flint 2 router by default runs GL.iNet firmware, which is a fork of the official OpenWRT project, aiming to provide ease of use, by limitting some of the features that stock OpenWRT provides.
Also the manufacturer can delay or stop delivering updates and features, while OpenWRT will be updated and maintained beyond that moment.
For these reasons, I've installed stock OpenWRT on the Flint 2, following the [OpenWRT wiki](https://openwrt.org/toh/gl.inet/gl-mt6000), which is a very easy process, as the original firmware is OpenWRT basically.

#### LuCI theme

After installing the stock OpenWRT, I liked to change the OpenWRT web interface (called LuCI) theme.
OpenWRT wiki has overview for [LuCI themes](https://openwrt.org/docs/guide-user/luci/luci.themes).
The theme that I like to use is called [Argon](https://github.com/jerrykuku/luci-theme-argon).
This theme provides both dark and light modes, and one can customize the accent colors, the login background and few more options.
The [theme's github repo](https://github.com/jerrykuku/luci-theme-argon) provides instructions how to install the theme.

![LuCI with Argon theme](/assets/img/homelab/luci-argon.png)
_LuCI (OpenWRT web interface) with Argon theme_

#### Wake-on-LAN (WoL)

Rarely, it happens to be power outage.
After power is restored, the router automatically turns on, but the computers usually don't.
This means that all the services hosted on the computers that are part of the homelab won't be available, until you manually power them on.

To resolve this issue, the computer network interface card (NIC) can listen to incoming network traffic even when the computer is OFF.
When a specific frame is sent on the network, called magic packet, containing the MAC address of the NIC, the NIC can power-on the computer, same effect as manually pressing the power-on button.
This feature is called [Wake-on-LAN (WoL)](https://en.wikipedia.org/wiki/Wake-on-LAN).

We can make the router send magic packet to a computer, to power it on.
To make WoL work properly, we need to configure both the router and the computer that needs to be awaken.
In this section, we will only configure the router, while the computer part will be presented later.

OpenWRT wiki has [page](https://openwrt.org/docs/guide-user/services/w_o_l/wol) for configuring WoL.
On the Flint 2, to use the WoL feature we need to install package called `etherwake`, which is a command-line utility that can generate and send magic packet.
Beside `etherwake`, there is also package called `luci-app-wol`, which basically adds option to utilize the WoL feature via the router web interface, under `Services -> Wake on LAN` page.
`luci-app-wol` will also install `etherwake` as its dependency.
Installing packages on OpenWRT is quite easy and can be done via LuCI, by going to `System -> Software`, then `Update lists...` to update the packages list and search and install the `luci-app-wol` package.
The installation can also be done via command line after connecting to the router via SSH, by issuing `opkg update && opkg install luci-app-wol`.

If we want to wake computer or any device that supports WoL automatically when the router boots, we can add `etherwake` command in `/etc/rc.local`:
```
# wake the computer with MAC aa:bb:cc:dd:ee:ff, connected on `br-lan` network interface
etherwake -i br-lan -b aa:bb:cc:dd:ee:ff

exit 0
```
{: file='/etc/rc.local'}

#### WireGuard VPN server

Often, we require access to our homelab network from outside.
To achieve this, we can use [VPN](https://en.wikipedia.org/wiki/Virtual_private_network).
In my scenario, I run WireGuard VPN server on the Flint 2 and use WireGuard client on my laptop and phone to access the homelab network when needed.

Before configuring the WireGuard server, we need to know the public IP address for our network.
There are multiple options for the public IP address:
1. The user has static IP, i.e. the address `92.56.292.123` always belonds to the user and never changes. This is the simplest scenario, but often ISP require users to pay additional money for this.
2. The user has dynamic IP address, which means his IP may change depending on some policy, i.e. after few hours or days. In this scenario the user can use [Dynamic DNS (DynDNS)](https://en.wikipedia.org/wiki/Dynamic_DNS) service, which basically updates given domain DNS record whenever the IP changes. There are many free DynDNS services that can be used. I use [`No-IP`](https://www.noip.com/), which provide DynDNS service for free, for single domain. After registering for DynDNS service, one needs to enter the domain and the security info for the domain on the router. Currently, I do that on the ISP gateway.
3. It is possible that the user public IP address is shared with multiple other users, by utilizing [CGNAT technology](https://en.wikipedia.org/wiki/Carrier-grade_NAT). This is the most tricky scenario, as the IP address is shared and I am not familiar with solutions for this scenario.

The OpenWRT wiki has [tutorial](https://openwrt.org/docs/guide-user/services/vpn/wireguard/server) for configuring WireGuard VPN server, both via command-line and via LuCI.
The process is straight forward:
1. Install the required package, `luci-proto-wireguard` should install everything that is required
2. Create new network interface with the `WireGuard VPN` protocol, named `wg0` for example
3. Press on the `Edit` button for the network interface and in the `General` tab press on `Generate new key pair` to generate the server public and private keys.
4. Enter the IP address for the VPN and the UDP listen port.
5. Ensure to assign firewall zone for this network interface. It can be the `lan` zone, used for the other devices that are part of the network.
6. Save all the changes.

After the server is configured, we can add peers, which is quite simple using the web interface:
1. Press on `Edit` on the WireGuard network interface, then go to the `Peers` tab.
2. Press on `Add peer` button
3. Generate the public/private key combo for the client
4. Add IPv4 address in the `Allowed IPs` field, on the same subnet as the one specified during server configuration.
5. Set the `Endpoint host` to the domain where your static IP is bound, or the DDNS domain.
6. Set `Persistent Keep Alive` to 25.
7. Save the peer configuration.
7. Then go and press `Edit` again and click on the `Generate Configuration...` button, to generate the config for the WireGuard client.

Sample WireGuard client config should look like this:
```
[Interface]
PrivateKey = GEKQHqEBBnCJXsFDVwKSZCy9VxV/OEBVUkLlISxBvVM=
Address = 10.10.0.10/32
DNS = 192.168.1.1

[Peer]
PublicKey = EjmgJpwmXgOWyaj3+ndUbbtRKs7FCn86xKpifzKOZj4=
PresharedKey = G3j9waP+Er04RVlSSk5MJgyNIwEW6z+Qybku8x4+eak=
AllowedIPs = 0.0.0.0/0, ::/0
Endpoint = example.domain.net:51820
PersistentKeepalive = 25
```
{: file='wg-client.conf'}

Finally, we need to configure the firewall to forward the WireGuard port.
This can be done via LuCI, by going to `Network -> Firewall` then `Port Forwards`.
Add new port forwarding rule, set the source to the WAN interface, external port to the WireGuard port, i.e. 51820 by default, set the destination zone to the WireGuard interface assigned firewall zone and set the internal port, often same as the external one.

With this, we can easily access our homelab network from anywhere!

> If you have another router in front of the one running the WireGuard server, you also need to do the port forwarding configuration on it. Another alternative is to enable [DMZ host (demilitarized zone)](https://en.wikipedia.org/wiki/DMZ_(computing)#DMZ_host) feature on the front router, which makes its firewall expose all ports to the DMZ host, which in our case is the router running WireGuard server.
{: .prompt-info }